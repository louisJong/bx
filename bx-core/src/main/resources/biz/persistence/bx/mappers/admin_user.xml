<?xml version="1.0" encoding= "UTF-8" ?>        
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="admin_user">
<resultMap id="admin_user" type="com.baojing.credit.model.AdminUser">
	<result column="id" property="id"/>
	<result column="user_name" property="userName"/>
	<result column="user_type" property="userType"/>
	<result column="telephone" property="telephone"/>
	<result column="com_name" property="comName"/>
	<result column="fax" property="fax"/>
	<result column="com_region" property="comRegion"/>
	<result column="com_address" property="comAddress"/>
	<result column="email" property="email"/>
	<result column="login_pwd" property="loginPwd"/>
	<result column="auth_start_time" property="authStartTime"/>
	<result column="auth_end_time" property="authEndTime"/>
	<result column="create_user" property="createUser"/>
	<result column="create_time" property="createTime"/>
	<result column="error_times" property="errorTimes"/>
	<result column="last_pwd_error_time" property="lastPwdErrorTime"/>
	<result column="last_pwd_modify_time" property="lastPwdModifyTime"/>
	<result column="update_time" property="updateTime"/>
	<result column="status" property="status"/>
	<result column="verify_msg" property="verifyMsg"/>
	<result column="role_id" property="roleId"/>
</resultMap>
<select id="findById" parameterType="long"  resultMap="admin_user">
	select * 	from admin_user where id=#{id}  
</select>  
<select id="findByUserNameAndPwd" parameterType="map"  resultType="map">
	select user_type userType, id userId	from admin_user where user_name=#{userName} and login_pwd=#{loginPwd}
</select>  
<select id="findByUserName" parameterType="string"  resultMap="admin_user">
	select * 	from admin_user where user_name=#{userName}  
</select>
<insert id="insert"  parameterType="com.baojing.credit.model.AdminUser"  useGeneratedKeys="true" keyProperty="id">
	insert into admin_user(id ,user_name ,user_type ,telephone ,com_name ,fax ,com_region ,com_address ,email ,login_pwd ,auth_start_time ,auth_end_time ,create_user ,create_time ,error_times ,last_pwd_error_time ,last_pwd_modify_time ,update_time ,status ,verify_msg ,remark ,role_id)
   values(#{id,jdbcType=INTEGER} ,#{userName,jdbcType=VARCHAR} ,#{userType,jdbcType=VARCHAR} ,#{telephone,jdbcType=VARCHAR} ,#{comName,jdbcType=VARCHAR} ,#{fax,jdbcType=VARCHAR} ,#{comRegion,jdbcType=VARCHAR} ,#{comAddress,jdbcType=VARCHAR} ,#{email,jdbcType=VARCHAR} ,#{loginPwd,jdbcType=VARCHAR} ,#{authStartTime,jdbcType=TIMESTAMP} ,#{authEndTime,jdbcType=TIMESTAMP} ,#{createUser,jdbcType=VARCHAR} ,#{createTime,jdbcType=TIMESTAMP} ,#{errorTimes,jdbcType=INTEGER} ,#{lastPwdErrorTime,jdbcType=TIMESTAMP} ,#{lastPwdModifyTime,jdbcType=TIMESTAMP} ,#{updateTime,jdbcType=TIMESTAMP} ,#{status,jdbcType=VARCHAR} ,#{verifyMsg,jdbcType=VARCHAR} ,#{remark,jdbcType=VARCHAR} ,#{roleId,jdbcType=INTEGER}) 
</insert>
<insert id="batchInsert"  parameterType="list">
	insert into admin_user(id ,user_name ,user_type ,telephone ,com_name ,fax ,com_region ,com_address ,email ,login_pwd ,auth_start_time ,auth_end_time ,create_user ,create_time ,error_times ,last_pwd_error_time ,last_pwd_modify_time ,update_time ,status ,verify_msg ,remark ,role_id)
   values
	<foreach collection="list" item="item" index="index"   separator=","> 
    (#{item.id,jdbcType=INTEGER} ,#{item.userName,jdbcType=VARCHAR} ,#{item.userType,jdbcType=VARCHAR} ,#{item.telephone,jdbcType=VARCHAR} ,#{item.comName,jdbcType=VARCHAR} ,#{item.fax,jdbcType=VARCHAR} ,#{item.comRegion,jdbcType=VARCHAR} ,#{item.comAddress,jdbcType=VARCHAR} ,#{item.email,jdbcType=VARCHAR} ,#{item.loginPwd,jdbcType=VARCHAR} ,#{item.authStartTime,jdbcType=TIMESTAMP} ,#{item.authEndTime,jdbcType=TIMESTAMP} ,#{item.createUser,jdbcType=VARCHAR} ,#{item.createTime,jdbcType=TIMESTAMP} ,#{item.errorTimes,jdbcType=INTEGER} ,#{item.lastPwdErrorTime,jdbcType=TIMESTAMP} ,#{item.lastPwdModifyTime,jdbcType=TIMESTAMP} ,#{item.updateTime,jdbcType=TIMESTAMP} ,#{item.status,jdbcType=VARCHAR} ,#{item.verifyMsg,jdbcType=VARCHAR} ,#{item.remark,jdbcType=VARCHAR} ,#{item.roleId,jdbcType=INTEGER})
	</foreach> 
</insert>
<update id="update"	parameterType="com.baojing.credit.model.AdminUser">
	update admin_user
<set>
	<if test="userType != null">user_type=#{userType},</if>
	<if test="telephone != null">telephone=#{telephone},</if>
	<if test="comName != null">com_name=#{comName},</if>
	<if test="fax != null">fax=#{fax},</if>
	<if test="comRegion != null">com_region=#{comRegion},</if>
	<if test="comAddress != null">com_address=#{comAddress},</if>
	<if test="email != null">email=#{email},</if>
	<if test="loginPwd != null">login_pwd=#{loginPwd},</if>
	<if test="authStartTime != null">auth_start_time=#{authStartTime},</if>
	<if test="authEndTime != null">auth_end_time=#{authEndTime},</if>
	<if test="errorTimes != null">error_times=#{errorTimes},</if>
	<if test="lastPwdErrorTime != null">last_pwd_error_time=#{lastPwdErrorTime},</if>
	<if test="lastPwdModifyTime != null">last_pwd_modify_time=#{lastPwdModifyTime},</if>
	<if test="updateTime != null">update_time=#{updateTime},</if>
	<if test="verifyMsg != null">verify_msg=#{verifyMsg},</if>
	<if test="status != null">status=#{status},</if>
	<if test="roleId != null">role_id=#{roleId}</if>
</set>
	where id=#{id}
</update>
<update id="modifyLoginPwd" parameterType="hashmap">
	update admin_user
	<set>
		<if test="newPwd != null">login_pwd=#{newPwd},</if>
		update_time=now(),
		last_pwd_modify_time=now()
	</set>
	where id=#{userId} and login_pwd=#{oldPwd}
</update>
<update id="setVerifyMsg" parameterType="hashmap">
	update admin_user
	<set>
		<if test="verifyMsg != null">verify_msg=#{verifyMsg},</if>
		update_time=now()
	</set>
	where id=#{userId}
</update>
</mapper>
